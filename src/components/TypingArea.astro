---

---

<section
  id="divText"
  class="relative flex flex-col w-full h-full items-center justify-center"
>
  <div
    id="quote-guide"
    class="absolute w-full max-w-4xl text-white/30 font-bold text-3xl/12 h-fit text-center whitespace-pre-wrap"
  >
  </div>
  <div
    id="quote-write"
    class="absolute w-full max-w-4xl text-3xl/12 font-bold text-center whitespace-pre-wrap"
  >
  </div>
</section>

<script type="module">
  async function getQuotes() {
    const response = await fetch(
      "https://quoteslate.vercel.app/api/quotes/random?minLength=200&maxLength=400"
    );
    const data = await response.json();
    return data;
  }

  const responseText = await getQuotes();

  function normalizeText(text) {
    return text
      .replace(/\s*\n\s*/g, " ") // ← CLAVE
      .replace(/[’‘]/g, "'")
      .replace(/[“”]/g, '"')
      .replace(/[—–]/g, "-")
      .normalize("NFKC");
  }

  const normalizedQuote = normalizeText(responseText.quote);

  const quoteGuide = document.getElementById("quote-guide");
  const quoteWrite = document.getElementById("quote-write");
  if (quoteGuide) {
    quoteGuide.textContent = `${normalizedQuote}`;
  }

  const quoteLetters = [];

  quoteLetters.push(normalizeText(responseText.quote));

  let currentIndex = 0;
  const specialKeys = [
    "Shift",
    "Control",
    "Alt",
    "AltGraph",
    "Meta",
    "CapsLock",
    "Tab",
    "ArrowUp",
    "ArrowDown",
    "ArrowLeft",
    "ArrowRight",
    "Escape",
    "Enter",
    "Delete",
    "Home",
    "End",
    "PageUp",
    "PageDown",
    "F1",
    "F2",
    "F3",
    "F4",
    "F5",
    "F6",
    "F7",
    "F8",
    "F9",
    "F10",
    "F11",
    "F12",
  ];

  const letters = quoteLetters[0].split("");
  letters.forEach((letter) => {
    const text = document.createElement("span");
    text.textContent = letter;

    text.classList.add("letter", "opacity-30");
    quoteWrite.appendChild(text);
  });

  const lettersSpan = document.querySelectorAll("#quote-write .letter");
  document.addEventListener("keydown", (e) => {
    if (specialKeys.includes(e.key)) return;
    if (currentIndex === letters.length) return;

    const expected = letters[currentIndex];
    const currentSpan = lettersSpan[currentIndex];

    if (e.key === expected) {
      currentSpan.classList.remove("opacity-30", "underline");
      currentSpan.classList.add("text-white");
      currentIndex++;
    } else {
      currentSpan.classList.remove("opacity-30");
      currentSpan.classList.add("text-red-400", "underline");
    }
  });
</script>
